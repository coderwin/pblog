# React和不断变化的网页交互方式

> 我从2000年开始就从事网站开发，在这期间我已经见证了框架和库时代的到来，Ajax时代开始的同jQuery时代也来了，Backbone也在后面几年出现了，大约在两年前，React时代到来了。它们每一个时代都带来了一个新的基于工具构建网站的实现方式。jQuery让开发者很方便的操作浏览器对象和强大的选择器（BOM和DOM），Backbone则给出更多的是客户端架构相关的，React则用UI组件代替了模板
> 有很多博客，讨论，和视频都在讲React是怎样工作的，为什么他对网站开发有如此多的好处，也有很多人在讨论虚拟DOM、HTML嵌入JS的JSX语法糖以及把UI通过组件的方式组织的好处，这些都是React很具有吸引力的技术片段，然而，我相信在技术方面并不是它流行的唯一理由，再做了一些研究后，我才意识到React为什么如此强大－－它从根本上改变了我们都已经工作多年的开发方式，他的思想比实现它的技术更强大

##不断变化的web交互方式

从DOM在浏览器中被广泛应用，web开发者有一个相同的感受是：DOM太慢，开发者们都想方设法去避免DOM更新、重绘、回流，简而言之，动态的更新网页确实存在一定的开销，他的开销大至分解成以下几个方面

* 性能—更新DOM缓慢是由于重绘和回流
* 效率—你创建节点引用可能带来内存泄漏
* 复杂性—确保在正确的位置分配和添加你的事件处理程序

当你停下来，看看这个，更新DOM成本是足够高，你从成本中获取的价值需要更高以证明你的开销。或者，你可以试着降低成本，这样的成本不需要高的价值来证明它。因此，我们开发了一系列的方法来尝试，降低成本：

* 只做小小的改变。大的变化是慢的，所以如果你能坚持到小的变化，它就会变快。
* 大的变化，从文档中分离的DOM节点，进行更改，然后重新将整个DOM节点重新放回去。这将避免重绘和回流。
* 使用事件代理去绑定事件，这样您就不会意外地删除具有重要事件处理程序的节点。

这每一个方法都会削减DOM的更新的开销，但是都没有从根本上解决问题

你永远不会想象发出一个命令来重新渲染整个页面，因为这无疑会导致一个糟糕的用户体验。然而这正是React所做到的

## react改变的方式

正如你毫无疑问地意识到，React解决了很多问题。
他为你管理了事件处理并且确保了在正确的时间正确的节点绑定和解绑，它高效的创建和销毁DOM结构，采用虚拟DOM去Diff组件的变化，并且只更新变化了的部分，所有这些技术的解决方案，改变了旧的方式，使得DOM更新快。

>有一些讨论说React到底是不是真正的快，这些讨论真的不是很重要，因为React的这种DOM更新方式是更快的，并且是一个重要的思想

切换到这种开发方式确实对我们的网站开发有一定的链式影响，这发生在我第一次看到React-router的时候

react-router的基本前提是URL变化，它是拦截history API的状态变化机制，然后渲染整个视图，在React之前，你不敢想象一次性地动态更新整个页面，因为那将是非常的慢，确保页面正确工作的复杂性是高的，而有些人会这样做，它无疑是错误的根源。所以我们只会坚持重新绘制页面的小部分。

但是有了React你将不会认为更新整个页面会重新渲染了两次，因为React不会重新渲染所有的节点，它将仅仅只需要渲染改变了的节点，每次渲染只是根据页面的改变部分，渲染成本保持相对一致，并且手动重新渲染页面的一部分和重新渲染整个页面之间的差别并不大。
React让我们重新思考编写Web应用程序的一些列页面。而不是把复杂的javascript 代码垒成一团，毫无疑问，已经有过很多开发人员开始使用React和React-router：他和传统的的服务端应用具有相同的模型：

	一个页面被渲染，页面发出请求作一些变化，然后这个页面渲染这些变化。唯一的区别是，这一切都发生在客户端。

## 结论

我仍然还在学习React，它的技术细节很有趣，它改变了动态网页交互的方式，对我来说真是印象深刻。最后我问自己的问题是：“如果没有客户端渲染的成本，你会怎样构建网站？” 我的思想飞跃到了多个方向，同时我也意识游戏的变化异常复杂，这方面React是怎样去做的。

任何工具，可以做的是，在他运用到项目中的时候能从根本上改变收益的情况，React已经在客户端的开发中做到了。

## 参考
[React + Performance = ? (aerotwist.com)](https://aerotwist.com/blog/react-plus-performance-equals-what/)
[React Router (github.com)](https://github.com/reactjs/react-router)
[History API (developer.mozilla.org)](https://developer.mozilla.org/en-US/docs/Web/API/History_API)

